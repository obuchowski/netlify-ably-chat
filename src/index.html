<!DOCTYPE html>
<html lang="en">

<head>
    <title>Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta charset="utf-8">
    <script lang="text/javascript">
        var channel = null
        const t = async () => {
            const user = prompt('Enter your name');
            const realtime = Ably.Realtime.Promise({authUrl: `/auth/?client=${user}`})
            channel = realtime.channels.get("[?rewind=100]default")

            await channel.subscribe((msg) => {
                console.log("Ably message received", msg)
                document.getElementById("response").innerHTML += "<br />" + JSON.stringify(msg)
            })

            channel.publish("greeting", user)
        }
    </script>
    <script lang="text/javascript" onload="t()" src="https://cdn.ably.com/lib/ably.min-1.js"></script>
<!--    <link rel="stylesheet" href="./styles.css">-->
</head>
<body>
    <div id="app">Chat App</div>
    <form id="message-form">
        <input type="text" name="message" placeholder="Enter message">
        <button>Send</button>
    </form>
    <button id="send-location">Send Location</button>

    <script lang="text/javascript">
        document.querySelector('#message-form').addEventListener('submit', (e) => {
            e.preventDefault()
            const message = e.target.elements.message.value
            channel.publish("message", message)
        })
    </script>
</body>
</html>